<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>WLAC Zero Textbook Cost (ZTC) â€” Course Search</title>
  <style>
    :root{
      --wlac-navy:#002147;
      --wlac-gold:#fdb813;
      --wlac-gray-100:#f7f7f8;
      --wlac-gray-200:#eeeeef;
      --text:#0f172a;
    }
    html,body{background:#fff;color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:0}
    header{padding:18px 12px 10px;text-align:center}
    header h1{margin:.25rem 0;color:var(--wlac-navy);font-size:clamp(1.2rem,2vw+1rem,2rem)}
    .top-actions{margin-top:8px;display:flex;gap:10px;justify-content:center;flex-wrap:wrap;align-items:center}
    .btn{background:var(--wlac-gold);color:#000;border:1px solid transparent;border-radius:10px;padding:10px 12px;font-weight:700;text-decoration:none;display:inline-block;cursor:pointer}
    .btn:hover{filter:brightness(1.05)}
    .btn-secondary{background:#f1f1f1;color:#000}
    .badge{display:inline-flex;align-items:center;gap:6px;padding:8px 10px;border:1px solid var(--wlac-gray-200);border-radius:999px;font-weight:700;color:var(--wlac-navy);background:#fff}
    .term-wrap{display:flex;gap:8px;align-items:center;background:#fff;border:1px solid var(--wlac-gray-200);border-radius:999px;padding:6px 10px}
    .term-wrap label{font-weight:700;color:var(--wlac-navy)}
    .term-wrap select{border:0;background:transparent;font-weight:600;outline:none}
    main{max-width:1100px;margin:0 auto;padding:14px 16px 28px}
    #search{width:100%;max-width:680px;margin:10px auto 6px;display:block;border:1px solid var(--wlac-gray-200);border-radius:10px;padding:12px 14px;font-size:1rem}
    .helper{margin:0 0 16px;text-align:center;color:#475569;font-size:.95rem}
    .table-wrap{overflow:auto;border:1px solid var(--wlac-gray-200);border-radius:12px;background:#fff}
    table{width:100%;border-collapse:separate;border-spacing:0}
    thead th{position:sticky;top:0;background:var(--wlac-navy);color:#fff;font-weight:700;text-align:left;padding:12px;border-bottom:1px solid var(--wlac-gray-200)}
    tbody td{padding:10px 12px;border-bottom:1px solid var(--wlac-gray-200)}
    tbody tr:nth-child(even){background:var(--wlac-gray-100)}
    tbody tr:hover{outline:2px solid rgba(0,33,71,.08)}
    .add-cell{display:flex;flex-direction:column;align-items:stretch}
    .term-badge{display:inline-block;margin-top:6px;padding:4px 8px;border:1px solid #eeeeef;border-radius:999px;font-size:.8rem;font-weight:700;color:#002147;background:#fff;line-height:1}
    footer{padding:22px 12px;text-align:center;color:#64748b}
  </style>
</head>
<body>
  <header>
    <h1>West Los Angeles College â€” Zero Textbook Cost (ZTC) Course Search</h1>
    <div class="top-actions">
      <span class="badge">ðŸ›’ Cart: <span id="cartBadge">0</span></span>
      <div class="term-wrap" title="This Term will be saved on each item you add">
        <label for="termSelect">Term</label>
        <select id="termSelect" aria-label="Term">
          <option>Fall 2025</option>
          <option>Winter 2026</option>
          <option>Spring 2026</option>
          <option>Summer 2026</option>
        </select>
      </div>
      <a class="btn" href="cart.html" rel="noopener">View Cart</a>
      <button class="btn btn-secondary" id="clearCartTop" type="button">Clear Cart</button>
    </div>
  </header>

  <main>
    <input type="text" id="search" placeholder="Search courses, sections, or instructorsâ€¦"/>
    <p class="helper">This page lists <strong>Zero Textbook Cost (ZTC)</strong> sections. Add courses to your cart, then open the cart page to copy, save, or print your list.</p>

    <div class="table-wrap">
      <table id="ztcTable" aria-describedby="search">
        <thead>
          <tr>
            <th>Course</th><th>Section</th><th>Instructor</th><th>Units</th><th>Days</th><th>Time</th><th>Location</th><th>Add</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </main>

  <footer>GO WEST. GO FAR. â€” West Los Angeles College â€¢ Culver City, CA</footer>

  <script src="scripts.js"></script>
  <script>
    (function(){
      const KEY='wlacZtcCartV1';
      const badge=document.getElementById('cartBadge');
      const clearBtn=document.getElementById('clearCartTop');
      const termSelect=document.getElementById('termSelect');

      const load=()=>{try{return JSON.parse(localStorage.getItem(KEY))||[]}catch{return[]}};
      const save=(arr)=> localStorage.setItem(KEY, JSON.stringify(arr));
      const renderBadge=()=>{ if(badge) badge.textContent = load().length; };

      // Patch WLAC_ZTC_CART to inject term and update badge
      function patchCartAPI(){
        if(!window.WLAC_ZTC_CART || window.WLAC_ZTC_CART.__patched) return;
        const origAdd=window.WLAC_ZTC_CART.add;
        const origClear=window.WLAC_ZTC_CART.clear;
        window.WLAC_ZTC_CART.add=function(item){
          const term=termSelect && termSelect.value ? termSelect.value : '';
          const withTerm=Object.assign({term}, item||{});
          origAdd.call(this, withTerm);
          renderBadge();
        };
        window.WLAC_ZTC_CART.clear=function(){ origClear.call(this); renderBadge(); };
        window.WLAC_ZTC_CART.__patched=true;
      }

      renderBadge();
      document.addEventListener('DOMContentLoaded', patchCartAPI);
      setInterval(renderBadge, 1000);
      window.addEventListener('storage', (e)=>{ if(e.key===KEY) renderBadge(); });

      if(clearBtn){
        clearBtn.addEventListener('click', ()=>{
          if(confirm('Clear all items from your cart?')){ save([]); renderBadge(); if(window.WLAC_ZTC_CART&&WLAC_ZTC_CART.clear) WLAC_ZTC_CART.clear(); }
        });
      }

      // Term badge live update (handled inside scripts.js for row badges)
      termSelect && termSelect.addEventListener('change', ()=>{
        document.querySelectorAll('.term-badge').forEach(el=> el.textContent = termSelect.value);
      });
    })();
  </script>
</body>
</html>
